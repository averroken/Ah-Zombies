{"version":3,"sources":["mini_game.js"],"names":["TopDownGame","gameProperties","screenWidth","screenHeight","states","game","player","enemy","bullets","background","firebutton","enemies","weapon","fireRate","nextFire","mini_game","prototype","create","this","add","tileSprite","position","physics","startSystem","Phaser","Physics","ARCADE","group","enableBody","physicsBodyType","i","world","randomX","randomY","name","body","immovable","anchor","setTo","width","height","scale","callAll","sprite","arcade","enable","allowRotation","collideWorldBounds","bulletSpeed","trackSprite","input","activePointer","isDown","update","overlap","killEnemy","keyboard","Keyboard","LEFT","x","RIGHT","UP","y","DOWN","Q","D","Z","S","rotation","angleToPointer","SPACEBAR","fire","bullet","kill","animations","play","events","onAnimationComplete","console","log","render","debug"],"mappings":"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","file":"mini_game.js","sourcesContent":["'use strict';\n\nvar TopDownGame = TopDownGame || {};\nvar gameProperties = {\n    screenWidth: '100%',\n    screenHeight: '100%'\n};\nvar states = {\n    game: \"game\"\n};\nvar player;\nvar enemy;\nvar bullets;\nvar background;\nvar firebutton;\nvar enemies;\nvar weapon;\nvar fireRate = 100;\nvar nextFire = 0;\nvar game = TopDownGame.game;\n\nTopDownGame.mini_game = function () {};\n\nTopDownGame.mini_game.prototype = {\n    create: function create() {\n        background = this.game.add.tileSprite(0, 0, 1920, 1080, \"background\");\n        if (!this.position) this.position = \"down\";\n\n        // enemy = game.add.sprite(Math.floor((Math.random()*300)+200),Math.floor((Math.random()*300)+200), 'enemy');\n        //     var walk = enemy.animations.add('walk', [40, 41, 42, 43, 44, 45, 46], 10, true);\n        //     var die = enemy.animations.add('die', [57, 58, 59, 60, 61, 62, 63,64,65,66,67,68,69,70,71,72], 10, true);\n        //\n        //     enemy.animations.play('walk', 15, true);\n\n        game.physics.startSystem(Phaser.Physics.ARCADE);\n\n        //Enemy\n        enemies = game.add.group();\n        enemies.enableBody = true;\n        enemies.physicsBodyType = Phaser.Physics.ARCADE;\n        for (var i = 0; i < 150; i++) {\n            enemy = enemies.create(game.world.randomX, game.world.randomY, 'enemy', 0);\n            enemy.name = 'enemy' + i;\n            enemy.body.immovable = true;\n            enemy.anchor.setTo(0.5);\n            enemy.body.width = 60;\n            enemy.body.height = 50;\n            enemy.scale.setTo(1, 1);\n        }\n\n        enemies.callAll('animations.add', 'animations', 'walk', [40, 41, 42, 43, 44, 45, 46], 15, true);\n\n        enemies.callAll('animations.add', 'animations', 'die', [66, 67, 68, 69, 70, 71, 72], 10, true);\n\n        enemies.callAll('animations.play', 'animations', 'walk');\n\n        player = game.add.sprite(400, 300, 'player2');\n        game.physics.arcade.enable([player]);\n        //Player\n\n        player.anchor.setTo(0.5, 0.5);\n        player.scale.setTo(0.3, 0.3);\n        player.body.allowRotation = false;\n        player.body.collideWorldBounds = true;\n\n        //Weapon\n        weapon = game.add.weapon(30, 'bullet');\n        weapon.fireRate = fireRate;\n        weapon.bulletSpeed = 2000;\n        weapon.trackSprite(player, 0, 15, true);\n        firebutton = this.input.activePointer.isDown;\n    },\n    update: function update() {\n        //game.physics.arcade.collide(enemies,weapon.bullets);\n        game.physics.arcade.overlap(weapon.bullets, enemies, this.killEnemy, null, this);\n        // enemies.forEach(function(enemy){\n        //     enemy.body.onCollide = new Phaser.Signal();\n        //     enemy.body.onCollide.add(killEnemy, this)\n        // });\n\n        if (game.input.keyboard.isDown(Phaser.Keyboard.LEFT)) {\n            player.x -= 4;\n        }\n        if (game.input.keyboard.isDown(Phaser.Keyboard.RIGHT)) {\n            player.x += 4;\n        }\n        if (game.input.keyboard.isDown(Phaser.Keyboard.UP)) {\n            player.y -= 4;\n        }\n        if (game.input.keyboard.isDown(Phaser.Keyboard.DOWN)) {\n            player.y += 4;\n        }\n        if (game.input.keyboard.isDown(Phaser.Keyboard.Q)) {\n            player.x -= 4;\n        }\n        if (game.input.keyboard.isDown(Phaser.Keyboard.D)) {\n            player.x += 4;\n        }\n        if (game.input.keyboard.isDown(Phaser.Keyboard.Z)) {\n            player.y -= 4;\n        }\n        if (game.input.keyboard.isDown(Phaser.Keyboard.S)) {\n            player.y += 4;\n        }\n        player.rotation = game.physics.arcade.angleToPointer(player);\n        if (game.input.activePointer.isDown || game.input.keyboard.isDown(Phaser.Keyboard.SPACEBAR)) {\n            weapon.fire();\n        }\n    },\n    killEnemy: function killEnemy(enemy, bullet) {\n        if (!bullet || !enemy) {\n            return;\n        }\n        bullet.kill();\n        enemy.animations.play('die', 15, false, true);\n        enemy.body.width = 0;\n        enemy.body.height = 0;\n        enemy.events.onAnimationComplete.add(function () {\n            console.log('Enemy is killed');\n            enemy.kill();\n        });\n    },\n    render: function render() {\n        weapon.debug();\n    }\n};"]}